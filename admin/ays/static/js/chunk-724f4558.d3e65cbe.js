(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-724f4558","chunk-2d23775c"],{"5a3d":function(e,t,i){},"634a":function(e,t,i){"use strict";i.r(t);var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"app-container"},[i("el-card",{staticClass:"filter-container",attrs:{shadow:"never"}},[i("div",[i("i",{staticClass:"el-icon-search"}),e._v(" "),i("span",[e._v("筛选搜索")]),e._v(" "),i("el-button",{staticStyle:{float:"right"},attrs:{type:"primary",size:"small"},on:{click:function(t){return e.handleSearchList()}}},[e._v("\n        查询搜索\n      ")]),e._v(" "),i("el-button",{staticStyle:{float:"right","margin-right":"15px"},attrs:{size:"small"},on:{click:function(t){return e.handleResetSearch()}}},[e._v("\n        重置\n      ")]),e._v(" "),i("el-button",{staticStyle:{float:"right"},attrs:{type:"primary",size:"small"},on:{click:function(t){return e.handleDownload()}}},[e._v("\n        导出\n      ")])],1),e._v(" "),i("div",{staticStyle:{"margin-top":"15px"}},[i("el-form",{attrs:{inline:!0,model:e.listQuery,size:"small","label-width":"140px"}},[i("el-form-item",{attrs:{label:"输入搜索："}},[i("el-input",{staticClass:"input-width",attrs:{placeholder:"订单编号"},model:{value:e.listQuery.orderSn,callback:function(t){e.$set(e.listQuery,"orderSn",t)},expression:"listQuery.orderSn"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"收货人："}},[i("el-input",{staticClass:"input-width",attrs:{placeholder:"收货人姓名/手机号码"},model:{value:e.listQuery.receiverKeyword,callback:function(t){e.$set(e.listQuery,"receiverKeyword",t)},expression:"listQuery.receiverKeyword"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"提交时间："}},[i("el-date-picker",{staticClass:"input-width",attrs:{type:"datetimerange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期"},model:{value:e.listQuery.createTime,callback:function(t){e.$set(e.listQuery,"createTime",t)},expression:"listQuery.createTime"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"订单状态："}},[i("el-select",{staticClass:"input-width",attrs:{placeholder:"全部",clearable:""},model:{value:e.listQuery.status,callback:function(t){e.$set(e.listQuery,"status",t)},expression:"listQuery.status"}},e._l(e.statusOptions,(function(e){return i("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),e._v(" "),i("el-form-item",{attrs:{label:"订单分类："}},[i("el-select",{staticClass:"input-width",attrs:{placeholder:"全部",clearable:""},model:{value:e.listQuery.orderType,callback:function(t){e.$set(e.listQuery,"orderType",t)},expression:"listQuery.orderType"}},e._l(e.orderTypeOptions,(function(e){return i("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),e._v(" "),i("el-form-item",{attrs:{label:"所属产品："}},[i("el-input",{staticClass:"input-width",attrs:{placeholder:"输入产品"},model:{value:e.listQuery.goodsname,callback:function(t){e.$set(e.listQuery,"goodsname",t)},expression:"listQuery.goodsname"}})],1)],1)],1)]),e._v(" "),i("el-card",{staticClass:"operate-container",attrs:{shadow:"never"}},[i("i",{staticClass:"el-icon-tickets"}),e._v(" "),i("span",[e._v("数据列表")])]),e._v(" "),i("div",{staticClass:"table-container"},[i("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],ref:"orderTable",staticStyle:{width:"100%"},attrs:{data:e.list,border:""},on:{"selection-change":e.handleSelectionChange}},[i("el-table-column",{attrs:{type:"selection",width:"60",align:"center"}}),e._v(" "),i("el-table-column",{attrs:{label:"编号",width:"80",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.id))]}}])}),e._v(" "),i("el-table-column",{attrs:{label:"微信流水单号",width:"180",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.out_trade_no))]}}])}),e._v(" "),i("el-table-column",{attrs:{label:"下单人",width:"180",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.buyerName))]}}])}),e._v(" "),i("el-table-column",{attrs:{label:"提交时间",width:"180",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.create_time))]}}])}),e._v(" "),i("el-table-column",{attrs:{label:"订单金额",width:"120",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("￥"+e._s(t.row.totalPrice))]}}])}),e._v(" "),i("el-table-column",{attrs:{label:"支付方式",width:"120",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("微信支付")]}}])}),e._v(" "),i("el-table-column",{attrs:{label:"订单状态",width:"120",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(e._f("stStrstatus")(t.row.status)))]}}])}),e._v(" "),i("el-table-column",{attrs:{label:"操作",fixed:"right",width:"200",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(i){return e.handleViewOrder(t.$index,t.row)}}},[e._v("查看订单\n          ")]),e._v(" "),i("el-button",{directives:[{name:"show",rawName:"v-show",value:0===t.row.status,expression:"scope.row.status===0"}],attrs:{size:"mini",type:"text"},on:{click:function(i){return e.handleCloseOrder(t.$index,t.row)}}},[e._v("关闭订单\n          ")]),e._v(" "),i("el-button",{directives:[{name:"show",rawName:"v-show",value:2===t.row.status,expression:"scope.row.status===2"}],attrs:{size:"mini",type:"text"},on:{click:function(i){return e.handleDeliveryOrder(t.$index,t.row)}}},[e._v("订单发货\n          ")]),e._v(" "),i("el-button",{directives:[{name:"show",rawName:"v-show",value:3===t.row.status||4===t.row.status||5===t.row.status,expression:"scope.row.status===3||scope.row.status===4||scope.row.status===5"}],attrs:{size:"mini",type:"text"},on:{click:function(i){return e.handleViewLogistics(t.$index,t.row)}}},[e._v("订单跟踪\n          ")]),e._v(" "),i("el-button",{directives:[{name:"show",rawName:"v-show",value:5===t.row.status,expression:"scope.row.status===5"}],attrs:{size:"mini",type:"text"},on:{click:function(i){return e.handleDeleteOrder(t.$index,t.row)}}},[e._v("删除订单\n          ")]),e._v(" "),-1!==t.row.status?i("el-button",{directives:[{name:"show",rawName:"v-show",value:t.row.status>1,expression:"scope.row.status>1"}],attrs:{size:"mini",type:"text"},on:{click:function(i){return e.handleRefundOrder(t.row)}}},[e._v("退款\n          ")]):e._e()]}}])})],1)],1),e._v(" "),i("div",{staticClass:"batch-operate-container"},[i("el-select",{attrs:{size:"small",placeholder:"批量操作"},model:{value:e.operateType,callback:function(t){e.operateType=t},expression:"operateType"}},e._l(e.operateOptions,(function(e){return i("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1),e._v(" "),i("el-button",{staticClass:"search-button",staticStyle:{"margin-left":"20px"},attrs:{type:"primary",size:"small"},on:{click:function(t){return e.handleBatchOperate()}}},[e._v("\n      确定\n    ")])],1),e._v(" "),i("div",{staticClass:"pagination-container"},[i("el-pagination",{attrs:{background:"",layout:"total, sizes,prev, pager, next,jumper","current-page":e.listQuery.page,"page-size":e.listQuery.limit,"page-sizes":[5,10,15],total:e.total},on:{"update:currentPage":function(t){return e.$set(e.listQuery,"page",t)},"update:current-page":function(t){return e.$set(e.listQuery,"page",t)},"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1),e._v(" "),i("el-dialog",{attrs:{title:"关闭订单",visible:e.closeOrder.dialogVisible,width:"30%"},on:{"update:visible":function(t){return e.$set(e.closeOrder,"dialogVisible",t)}}},[i("span",{staticStyle:{"vertical-align":"top"}},[e._v("操作备注：")]),e._v(" "),i("el-input",{staticStyle:{width:"80%"},attrs:{type:"textarea",rows:5,placeholder:"请输入内容"},model:{value:e.closeOrder.content,callback:function(t){e.$set(e.closeOrder,"content",t)},expression:"closeOrder.content"}}),e._v(" "),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(t){e.closeOrder.dialogVisible=!1}}},[e._v("取 消")]),e._v(" "),i("el-button",{attrs:{type:"primary"},on:{click:e.handleCloseOrderConfirm}},[e._v("确 定")])],1)],1),e._v(" "),i("logistics-dialog",{attrs:{courlist:e.courlist},model:{value:e.logisticsDialogVisible,callback:function(t){e.logisticsDialogVisible=t},expression:"logisticsDialogVisible"}})],1)},l=[],s=(i("6b54"),i("f8b7")),r=i("6724"),a=i("fae0"),o=i("b775");function u(e){return Object(o["a"])({url:"api/Courier/getlist",method:"get",params:e})}var c={page:1,limit:10},d={name:"OrderList",components:{LogisticsDialog:a["default"]},directives:{waves:r["a"]},filters:{nature:function(e){return 1===e?"正式用户":"游客"},stStrstatus:function(e){return 1===e?"待付款":2===e?"已付款":3===e?"已发货":-1===e?"已退款":"订单完成"},statusFilter:function(e){return 1===e?"是":"否"}},data:function(){return{listQuery:Object.assign({},c),listLoading:!0,list:null,total:null,operateType:null,multipleSelection:[],closeOrder:{dialogVisible:!1,content:null,orderIds:[]},statusOptions:[{label:"待付款",value:1},{label:"已支付",value:2},{label:"已发货",value:3},{label:"已完成",value:4},{label:"已关闭",value:4}],orderTypeOptions:[{label:"正常订单",value:0},{label:"秒杀订单",value:1}],sourceTypeOptions:[{label:"PC订单",value:0},{label:"APP订单",value:1}],operateOptions:[{label:"设为店长",value:1},{label:"社会",value:2},{label:"删除订单",value:3}],courlist:[],logisticsDialogVisible:!1}},created:function(){this.listQuery.page=this.$route.query.page||1,this.getList()},methods:{handleRefundOrder:function(e){var t=this;Object(s["d"])(e).then((function(e){t.$message.success("退款成功"),t.getList()}))},handleResetSearch:function(){this.listQuery=Object.assign({},c)},handleSearchList:function(){this.listQuery.page=1,this.getList()},handleSelectionChange:function(e){this.multipleSelection=e},handleViewOrder:function(e,t){this.$router.push({path:"/order/orderDetail",query:{id:t.id}})},handleCloseOrder:function(e,t){this.closeOrder.dialogVisible=!0,this.closeOrder.orderIds=[t.id]},handleDeliveryOrder:function(e,t){var i=this.covertOrder(t);this.$router.push({path:"/order/deliver",query:{list:[i],page:this.listQuery.page}})},handleViewLogistics:function(e,t){var i=this;if("TC"===t.deliveryCompany)return this.$message.error("同城快递不支持物流更新"),!0;var n={deliveryCompany:t.deliveryCompany,deliverySn:t.deliverySn};u(n).then((function(e){i.courlist=e.data.result.list})),this.logisticsDialogVisible=!0},handleDeleteOrder:function(e,t){var i=[];i.push(t.id),this.deleteOrder(i)},handleBatchOperate:function(){if(null==this.multipleSelection||this.multipleSelection.length<1)this.$message({message:"请选择要操作的订单",type:"warning",duration:1e3});else if(1===this.operateType){for(var e=[],t=0;t<this.multipleSelection.length;t++)1===this.multipleSelection[t].status&&e.push(this.covertOrder(this.multipleSelection[t]));if(0===e.length)return void this.$message({message:"选中订单中没有可以发货的订单",type:"warning",duration:1e3});this.$router.push({path:"/oms/deliverOrderList",query:{list:e}})}else if(2===this.operateType){this.closeOrder.orderIds=[];for(var i=0;i<this.multipleSelection.length;i++)this.closeOrder.orderIds.push(this.multipleSelection[i].id);this.closeOrder.dialogVisible=!0}else if(3===this.operateType){for(var n=[],l=0;l<this.multipleSelection.length;l++)n.push(this.multipleSelection[l].id);this.deleteOrder(n)}},handleSizeChange:function(e){this.listQuery.page=1,this.listQuery.limit=e,this.getList()},handleCurrentChange:function(e){this.listQuery.page=e,this.getList()},handleCloseOrderConfirm:function(){var e=this;if(null!=this.closeOrder.content&&""!==this.closeOrder.content){var t=new URLSearchParams;t.append("ids",this.closeOrder.orderIds),t.append("note",this.closeOrder.content),Object(s["closeOrder"])(t).then((function(t){e.closeOrder.orderIds=[],e.closeOrder.dialogVisible=!1,e.getList(),e.$message({message:"修改成功",type:"success",duration:1e3})}))}else this.$message({message:"操作备注不能为空",type:"warning",duration:1e3})},getList:function(){var e=this;this.listLoading=!0,Object(s["a"])(this.listQuery).then((function(t){e.listLoading=!1,e.list=t.data.data,e.total=t.data.total}))},deleteOrder:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e){var t=this;this.$confirm("是否要进行该删除操作?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){var i=new URLSearchParams;i.append("ids",e),deleteOrder(i).then((function(e){t.$message({message:"删除成功！",type:"success",duration:1e3}),t.getList()}))}))})),covertOrder:function(e){var t={id:e.id,out_trade_no:e.out_trade_no,buyerName:e.buyerName,mobile:e.mobile,addressText:e.addressText,deliveryCompany:null,deliverySn:null};return t},handleDownload:function(){var e=this;this.listLoading=!0,Object(s["c"])(this.listQuery).then((function(t){Promise.all([i.e("chunk-6e83591c"),i.e("chunk-04b34721"),i.e("chunk-58293907")]).then(i.bind(null,"4bf8d")).then((function(i){var n=t.data.tHeader,l=t.data.filterVal,s=e.formatJson(t.data.data,l),r=new Date;r.setTime(r.getTime());var a=r.getFullYear()+"-"+(r.getMonth()+1)+"-"+r.getDate();i.export_json_to_excel({header:n,data:s,filename:"安装单-"+a}),e.listLoading=!1,e.$message.success("下载成功")}))}))},formatJson:function(e,t){return e.map((function(e){return t.map((function(t){return"timestamp"===t?parseTime(e[t]):e[t]}))}))}}},p=d,h=(i("b7cd"),i("2877")),v=Object(h["a"])(p,n,l,!1,null,"35d46be0",null);t["default"]=v.exports},6724:function(e,t,i){"use strict";i("8d41");var n="@@wavesContext";function l(e,t){function i(i){var n=Object.assign({},t.value),l=Object.assign({ele:e,type:"hit",color:"rgba(0, 0, 0, 0.15)"},n),s=l.ele;if(s){s.style.position="relative",s.style.overflow="hidden";var r=s.getBoundingClientRect(),a=s.querySelector(".waves-ripple");switch(a?a.className="waves-ripple":(a=document.createElement("span"),a.className="waves-ripple",a.style.height=a.style.width=Math.max(r.width,r.height)+"px",s.appendChild(a)),l.type){case"center":a.style.top=r.height/2-a.offsetHeight/2+"px",a.style.left=r.width/2-a.offsetWidth/2+"px";break;default:a.style.top=(i.pageY-r.top-a.offsetHeight/2-document.documentElement.scrollTop||document.body.scrollTop)+"px",a.style.left=(i.pageX-r.left-a.offsetWidth/2-document.documentElement.scrollLeft||document.body.scrollLeft)+"px"}return a.style.backgroundColor=l.color,a.className="waves-ripple z-active",!1}}return e[n]?e[n].removeHandle=i:e[n]={removeHandle:i},i}var s={bind:function(e,t){e.addEventListener("click",l(e,t),!1)},update:function(e,t){e.removeEventListener("click",e[n].removeHandle,!1),e.addEventListener("click",l(e,t),!1)},unbind:function(e){e.removeEventListener("click",e[n].removeHandle,!1),e[n]=null,delete e[n]}},r=function(e){e.directive("waves",s)};window.Vue&&(window.waves=s,Vue.use(r)),s.install=r;t["a"]=s},"8d41":function(e,t,i){},b7cd:function(e,t,i){"use strict";var n=i("5a3d"),l=i.n(n);l.a},f8b7:function(e,t,i){"use strict";i.d(t,"a",(function(){return l})),i.d(t,"b",(function(){return s})),i.d(t,"g",(function(){return r})),i.d(t,"d",(function(){return a})),i.d(t,"c",(function(){return o}));var n=i("b775");function l(e){return Object(n["a"])({url:"/admin/Order/GetDataByList",method:"get",params:e})}function s(e){return Object(n["a"])({url:"/admin/Order/GetIdByDetails",method:"get",params:{id:e}})}function r(e){return Object(n["a"])({url:"/admin/Order/deliveryOrder",method:"post",data:e})}function a(e){return Object(n["a"])({url:"/admin/Order/PostDataByRefund",method:"post",data:e})}function o(e){return Object(n["a"])({url:"/admin/Order/GetQueryBydownload",method:"get",params:e})}},fae0:function(e,t,i){"use strict";i.r(t);var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("el-dialog",{attrs:{title:"订单跟踪",visible:e.visible,"before-close":e.handleClose,width:"40%"},on:{"update:visible":function(t){e.visible=t}}},[i("el-steps",{attrs:{direction:"vertical",active:6,"finish-status":"success",space:"50px"}},e._l(e.courlist,(function(e){return i("el-step",{key:e.status,attrs:{title:e.status,description:e.time}})})),1)],1)},l=[],s=[{name:"订单已提交，等待付款",time:"2017-04-01 12:00:00 "},{name:"订单付款成功",time:"2017-04-01 12:00:00 "},{name:"在北京市进行下级地点扫描，等待付款",time:"2017-04-01 12:00:00 "},{name:"在分拨中心广东深圳公司进行卸车扫描，等待付款",time:"2017-04-01 12:00:00 "},{name:"在广东深圳公司进行发出扫描",time:"2017-04-01 12:00:00 "},{name:"到达目的地网点广东深圳公司，快件将很快进行派送",time:"2017-04-01 12:00:00 "},{name:"订单已签收，期待再次为您服务",time:"2017-04-01 12:00:00 "}],r={name:"LogisticsDialog",props:{value:Boolean,courlist:{type:Array,default:[]}},data:function(){return{logisticsList:Object.assign({},s)}},computed:{visible:{get:function(){return this.value},set:function(e){this.value=e}}},methods:{emitInput:function(e){this.$emit("input",e)},handleClose:function(){this.emitInput(!1)}}},a=r,o=i("2877"),u=Object(o["a"])(a,n,l,!1,null,null,null);t["default"]=u.exports}}]);